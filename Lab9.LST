SQL> select * from emp;

     EMPNO ENAME      JOB              MGR HIREDATE         SAL       COMM      
---------- ---------- --------- ---------- --------- ---------- ----------      
    DEPTNO                                                                      
----------                                                                      
      7369 SMITH      CLERK           7902 17-DEC-80        800                 
        20                                                                      
                                                                                
      7499 ALLEN      SALESMAN        7698 20-FEB-81       1600        300      
        30                                                                      
                                                                                
      7521 WARD       SALESMAN        7698 22-FEB-81       1250        500      
        30                                                                      
                                                                                

     EMPNO ENAME      JOB              MGR HIREDATE         SAL       COMM      
---------- ---------- --------- ---------- --------- ---------- ----------      
    DEPTNO                                                                      
----------                                                                      
      7566 JONES      MANAGER         7839 02-APR-81       2975                 
        20                                                                      
                                                                                
      7654 MARTIN     SALESMAN        7698 28-SEP-81       1250       1400      
        30                                                                      
                                                                                
      7698 BLAKE      MANAGER         7839 01-MAY-81       2850                 
        30                                                                      
                                                                                

     EMPNO ENAME      JOB              MGR HIREDATE         SAL       COMM      
---------- ---------- --------- ---------- --------- ---------- ----------      
    DEPTNO                                                                      
----------                                                                      
      7782 CLARK      MANAGER         7839 09-JUN-81       2450                 
        10                                                                      
                                                                                
      7788 SCOTT      ANALYST         7566 09-DEC-82       3000                 
        20                                                                      
                                                                                
      7839 KING       PRESIDENT            17-NOV-81       5000                 
        10                                                                      
                                                                                

     EMPNO ENAME      JOB              MGR HIREDATE         SAL       COMM      
---------- ---------- --------- ---------- --------- ---------- ----------      
    DEPTNO                                                                      
----------                                                                      
      7844 TURNER     SALESMAN        7698 08-SEP-81       1500          0      
        30                                                                      
                                                                                
      7876 ADAMS      CLERK           7788 12-JAN-83       1100                 
        20                                                                      
                                                                                
      7900 JAMES      CLERK           7698 03-DEC-81        950                 
        30                                                                      
                                                                                

     EMPNO ENAME      JOB              MGR HIREDATE         SAL       COMM      
---------- ---------- --------- ---------- --------- ---------- ----------      
    DEPTNO                                                                      
----------                                                                      
      7902 FORD       ANALYST         7566 03-DEC-81       3000                 
        20                                                                      
                                                                                
      7934 MILLER     CLERK           7782 23-JAN-82       1300                 
        10                                                                      
                                                                                

14 rows selected.

SQL> 
SQL> 
SQL>  select distinct(data_ang)
  2   from angajati
  3   where to_char(data_ang, 'MON') IN ('DEC', 'JAN', 'FEB');

DATA_ANG                                                                        
---------                                                                       
09-DEC-82                                                                       
12-JAN-83                                                                       
23-JAN-82                                                                       
22-FEB-81                                                                       
03-DEC-81                                                                       
20-FEB-81                                                                       
17-DEC-80                                                                       

7 rows selected.

SQL> selectd.den_dep,
SP2-0734: unknown command beginning "selectd.de..." - rest of line ignored.
SQL>  a.functie,
  3*  where to_char(data_ang, 'MON') IN ('DEC', 'JAN', 'FEB').functie,
SQL>  count(a.id_ang) nr_ang
SP2-0734: unknown command beginning "count(a.id..." - rest of line ignored.
SQL>  from angajati a
SP2-0734: unknown command beginning "from angaj..." - rest of line ignored.
SQL>  natural join departamente d
SP2-0734: unknown command beginning "natural jo..." - rest of line ignored.
SQL>  group byd.den_dep,
SP2-0734: unknown command beginning "group byd...." - rest of line ignored.
SP2-0044: For a list of known commands enter HELP
and to leave enter EXIT.
SQL>  a.functie
  3*  where to_char(data_ang, 'MON') IN ('DEC', 'JAN', 'FEB').functie,.functie
SQL>  having count(a.id_ang) = (select max(count(id_ang))
SP2-0734: unknown command beginning "having cou..." - rest of line ignored.
SQL>  from angajati
SP2-0734: unknown command beginning "from angaj..." - rest of line ignored.
SQL>  group by id_dep,
SP2-0734: unknown command beginning "group by i..." - rest of line ignored.
SQL>   functie);selectd.den_dep,
SP2-0734: unknown command beginning "functie);s..." - rest of line ignored.
SP2-0044: For a list of known commands enter HELP
and to leave enter EXIT.
SQL>  a.functie,
  3*  where to_char(data_ang, 'MON') IN ('DEC', 'JAN', 'FEB').functie,.functie.functie,
SQL>  count(a.id_ang) nr_ang
SP2-0734: unknown command beginning "count(a.id..." - rest of line ignored.
SQL>  from angajati a
SP2-0734: unknown command beginning "from angaj..." - rest of line ignored.
SQL>  natural join departamente d
SP2-0734: unknown command beginning "natural jo..." - rest of line ignored.
SQL>  group byd.den_dep,
SP2-0734: unknown command beginning "group byd...." - rest of line ignored.
SP2-0044: For a list of known commands enter HELP
and to leave enter EXIT.
SQL>  a.functie
  3*  where to_char(data_ang, 'MON') IN ('DEC', 'JAN', 'FEB').functie,.functie.functie,.functie
SQL>  having count(a.id_ang) = (select max(count(id_ang))
SP2-0734: unknown command beginning "having cou..." - rest of line ignored.
SQL>  from angajati
SP2-0734: unknown command beginning "from angaj..." - rest of line ignored.
SQL>  group by id_dep,
SP2-0734: unknown command beginning "group by i..." - rest of line ignored.
SQL>   functie);select
SP2-0734: unknown command beginning "functie);s..." - rest of line ignored.
SP2-0044: For a list of known commands enter HELP
and to leave enter EXIT.
SQL> d.den_dep,
SP2-0042: unknown command "d.den_dep," - rest of line ignored.
SQL>  a.functie,
  3*  where to_char(data_ang, 'MON') IN ('DEC', 'JAN', 'FEB').functie,.functie.functie,.functie.functie,
SQL>  count(a.id_ang) nr_ang
SP2-0734: unknown command beginning "count(a.id..." - rest of line ignored.
SQL>  from angajati a
SP2-0734: unknown command beginning "from angaj..." - rest of line ignored.
SQL>  natural join departamente d
SP2-0734: unknown command beginning "natural jo..." - rest of line ignored.
SQL>  group byd.den_dep,
SP2-0734: unknown command beginning "group byd...." - rest of line ignored.
SP2-0044: For a list of known commands enter HELP
and to leave enter EXIT.
SQL>  a.functie
  3*  where to_char(data_ang, 'MON') IN ('DEC', 'JAN', 'FEB').functie,.functie.functie,.functie.functie,.functie
SQL>  having count(a.id_ang) = (select max(count(id_ang))
SP2-0734: unknown command beginning "having cou..." - rest of line ignored.
SQL>  from angajati
SP2-0734: unknown command beginning "from angaj..." - rest of line ignored.
SQL>  group by id_dep,
SP2-0734: unknown command beginning "group by i..." - rest of line ignored.
SQL>   functie);select  d.den_dep,
SP2-0734: unknown command beginning "functie);s..." - rest of line ignored.
SP2-0044: For a list of known commands enter HELP
and to leave enter EXIT.
SQL>  a.functie,
  3*  where to_char(data_ang, 'MON') IN ('DEC', 'JAN', 'FEB').functie,.functie.functie,.functie.functie,.functie.functie,
SQL>  count(a.id_ang) nr_ang
SP2-0734: unknown command beginning "count(a.id..." - rest of line ignored.
SQL>  from angajati a
SP2-0734: unknown command beginning "from angaj..." - rest of line ignored.
SQL>  natural join departamente d
SP2-0734: unknown command beginning "natural jo..." - rest of line ignored.
SQL>  group by d.den_dep,
SP2-0734: unknown command beginning "group by d..." - rest of line ignored.
SP2-0044: For a list of known commands enter HELP
and to leave enter EXIT.
SQL>  a.functie
  3*  where to_char(data_ang, 'MON') IN ('DEC', 'JAN', 'FEB').functie,.functie.functie,.functie.functie,.functie.functie,.functie
SQL>  having count(a.id_ang) = (select max(count(id_ang))
SP2-0734: unknown command beginning "having cou..." - rest of line ignored.
SQL>  from angajati
SP2-0734: unknown command beginning "from angaj..." - rest of line ignored.
SQL>  group by id_dep,
SP2-0734: unknown command beginning "group by i..." - rest of line ignored.
SQL>   functie);
SP2-0042: unknown command "functie)" - rest of line ignored.
SP2-0044: For a list of known commands enter HELP
and to leave enter EXIT.
SQL> select  d.den_dep,
  2   a.functie,
  3   count(a.id_ang) nr_ang
  4   from angajati a
  5   natural join departamente d
  6   group by d.den_dep,
  7   a.functie
  8   having count(a.id_ang) = (select max(count(id_ang))
  9   from angajati
 10   group by id_dep,
 11    functie);

DEN_DEP        FUNCTIE       NR_ANG                                             
-------------- --------- ----------                                             
SALES          SALESMAN           4                                             

SQL> define id_dep = 30
SQL>  selectd.den_dep,
SP2-0734: unknown command beginning "selectd.de..." - rest of line ignored.
SQL>  a.nume,
 11*   functie).nume,
SQL>  a.functie,
 11*   functie).nume,.functie,
SQL>  a.comision
 11*   functie).nume,.functie,.comision
SQL>  from
SP2-0042: unknown command "from" - rest of line ignored.
SQL>  angajati a
SP2-0042: unknown command "angajati a" - rest of line ignored.
SQL>  inner join departamente d
SP2-0734: unknown command beginning "inner join..." - rest of line ignored.
SQL>  on a.id_dep = d.id_dep
SP2-0734: unknown command beginning "on a.id_de..." - rest of line ignored.
SP2-0044: For a list of known commands enter HELP
and to leave enter EXIT.
SQL>  group by
SP2-0042: unknown command "group by" - rest of line ignored.
SQL>  d.den_dep,
SP2-0042: unknown command "d.den_dep," - rest of line ignored.
SQL>  a.nume,
 11*   functie).nume,.functie,.comision.nume,
SQL>  a.functie,
 11*   functie).nume,.functie,.comision.nume,.functie,
SQL>  a.comision
 11*   functie).nume,.functie,.comision.nume,.functie,.comision
SQL>  having max(a.comision) in (select max(comision)
SP2-0734: unknown command beginning "having max..." - rest of line ignored.
SQL>  from angajati
SP2-0734: unknown command beginning "from angaj..." - rest of line ignored.
SQL>  where id_dep = &id_dep
SP2-0734: unknown command beginning "where id_d..." - rest of line ignored.
SQL>  group by id_dep)
SP2-0734: unknown command beginning "group by i..." - rest of line ignored.
SP2-0044: For a list of known commands enter HELP
and to leave enter EXIT.
SQL>  order by 2;
SP2-0042: unknown command "order by 2" - rest of line ignored.
SQL> define id_dep = 30
SQL>  selectd.den_dep,
SP2-0734: unknown command beginning "selectd.de..." - rest of line ignored.
SQL>  a.nume,
 11*   functie).nume,.functie,.comision.nume,.functie,.comision.nume,
SQL>  a.functie,
 11*   functie).nume,.functie,.comision.nume,.functie,.comision.nume,.functie,
SQL>  a.comision
 11*   functie).nume,.functie,.comision.nume,.functie,.comision.nume,.functie,.comision
SQL>  from
SP2-0042: unknown command "from" - rest of line ignored.
SQL>  angajati a
SP2-0042: unknown command "angajati a" - rest of line ignored.
SQL>  inner join departamente d
SP2-0734: unknown command beginning "inner join..." - rest of line ignored.
SQL>  on a.id_dep = d.id_dep
SP2-0734: unknown command beginning "on a.id_de..." - rest of line ignored.
SP2-0044: For a list of known commands enter HELP
and to leave enter EXIT.
SQL>  group by
SP2-0042: unknown command "group by" - rest of line ignored.
SQL>  d.den_dep,
SP2-0042: unknown command "d.den_dep," - rest of line ignored.
SQL>  a.nume,
 11*   functie).nume,.functie,.comision.nume,.functie,.comision.nume,.functie,.comision.nume,
SQL>  a.functie,
 11*   functie).nume,.functie,.comision.nume,.functie,.comision.nume,.functie,.comision.nume,.functie,
SQL>  a.comision
 11*   functie).nume,.functie,.comision.nume,.functie,.comision.nume,.functie,.comision.nume,.functie,.comision
SQL>  having max(a.comision) in (select max(comision)
SP2-0734: unknown command beginning "having max..." - rest of line ignored.
SQL>  from angajati
SP2-0734: unknown command beginning "from angaj..." - rest of line ignored.
SQL>  where id_dep = &id_dep
SP2-0734: unknown command beginning "where id_d..." - rest of line ignored.
SQL>  group by id_dep)
SP2-0734: unknown command beginning "group by i..." - rest of line ignored.
SP2-0044: For a list of known commands enter HELP
and to leave enter EXIT.
SQL>  order by 2;
SP2-0042: unknown command "order by 2" - rest of line ignored.
SQL> define id_dep = 30
SQL>  select
  2  d.den_dep,
  3   a.nume,
  4   a.functie,
  5   a.comision
  6   from
  7   angajati a
  8   inner join departamente d
  9   on a.id_dep = d.id_dep
 10   group by
 11   d.den_dep,
 12   a.nume,
 13   a.functie,
 14   a.comision
 15   having max(a.comision) in (select max(comision)  from angajati
 16   where id_dep = &id_dep
 17   group by id_dep)
 18   order by 2;
old  16:  where id_dep = &id_dep
new  16:  where id_dep = 30

DEN_DEP        NUME       FUNCTIE     COMISION                                  
-------------- ---------- --------- ----------                                  
SALES          MARTIN     SALESMAN        1400                                  

SQL> 
SQL> select
  2          a.nume,
  3   a.functie,
  4   a.data_ang,
  5   a.salariu
  6   from
  7   angajati a,
  8   (select id_dep,
  9   max(salariu) sal_max_dep
 10   from angajati
 11   group by id_dep) b
 12   group by
 13   a.nume,
 14   a.functie,
 15   a.data_ang,
 16   a.salariu
 17   having a.salariu = max(b.sal_max_dep)
 18   order by a.nume;

NUME       FUNCTIE   DATA_ANG     SALARIU                                       
---------- --------- --------- ----------                                       
KING       PRESIDENT 17-NOV-81       5000                                       

SQL> select nume nume_ang,
  2   (select nume
  3   from angajati
  4   where id_ang = a.id_sef) nume_sef
  5   from angajati a
  6   where id_dep = 20
  7   order by nume;

NUME_ANG   NUME_SEF                                                             
---------- ----------                                                           
ADAMS      SCOTT                                                                
FORD       JONES                                                                
JONES      KING                                                                 
SCOTT      JONES                                                                
SMITH      FORD                                                                 

SQL> select id_dep, nume, functie
  2   from angajati a
  3   where id_dep in (10, 20)
  4   order by (select count(*)
  5   from angajati b
  6   where a.id_dep = b.id_dep) desc;

    ID_DEP NUME       FUNCTIE                                                   
---------- ---------- ---------                                                 
        20 SMITH      CLERK                                                     
        20 JONES      MANAGER                                                   
        20 SCOTT      ANALYST                                                   
        20 FORD       ANALYST                                                   
        20 ADAMS      CLERK                                                     
        10 KING       PRESIDENT                                                 
        10 MILLER     CLERK                                                     
        10 CLARK      MANAGER                                                   

8 rows selected.

SQL> select id_dep,
  2  nume,
  3  functie,
  4  salariu
  5  from angajati
  6  where salariu > some(select distinct(salariu)
  7  from angajati
  8  where functie = 'SALESMAN')
  9  order by id_dep, nume;

    ID_DEP NUME       FUNCTIE      SALARIU                                      
---------- ---------- --------- ----------                                      
        10 CLARK      MANAGER         2450                                      
        10 KING       PRESIDENT       5000                                      
        10 MILLER     CLERK           1300                                      
        20 FORD       ANALYST         3000                                      
        20 JONES      MANAGER         2975                                      
        20 SCOTT      ANALYST         3000                                      
        30 ALLEN      SALESMAN        1600                                      
        30 BLAKE      MANAGER         2850                                      
        30 TURNER     SALESMAN        1500                                      

9 rows selected.

SQL> select id_dep,
  2  nume,
  3  functie,
  4  salariu
  5  from angajati
  6  where salariu >= ALL(select distinct salariu
  7  from angajati
  8  where functie = 'SALESMAN')
  9  order by id_dep,
 10  nume;

    ID_DEP NUME       FUNCTIE      SALARIU                                      
---------- ---------- --------- ----------                                      
        10 CLARK      MANAGER         2450                                      
        10 KING       PRESIDENT       5000                                      
        20 FORD       ANALYST         3000                                      
        20 JONES      MANAGER         2975                                      
        20 SCOTT      ANALYST         3000                                      
        30 ALLEN      SALESMAN        1600                                      
        30 BLAKE      MANAGER         2850                                      

7 rows selected.

SQL> select d.id_dep,
  2  d.den_dep
  3  form departamente d
  4  where exists(select nume
  5  from angajati
  6  where id_dep = d.id_dep)
  7  order by id_dep;
form departamente d
     *
ERROR at line 3:
ORA-00923: FROM keyword not found where expected 


SQL> select d.id_dep,
  2  d.den_dep
  3  from departamente d
  4  where exists(select nume
  5  from angajati
  6  where id_dep = d.id_dep)
  7  order by id_dep;

    ID_DEP DEN_DEP                                                              
---------- --------------                                                       
        10 ACCOUNTING                                                           
        20 RESEARCH                                                             
        30 SALES                                                                

SQL> select id_dep,
  2  id_ang,
  3  nume,
  4  functie,
  5  id_sef
  6  from angajati a
  7  where not exists(select id_sef
  8  from angajati
  9  where id_ang = a.id_sef)
 10  order by id_dep;

    ID_DEP     ID_ANG NUME       FUNCTIE       ID_SEF                           
---------- ---------- ---------- --------- ----------                           
        10       7839 KING       PRESIDENT                                      

SQL> select id_dep,
  2  id_ang,
  3  nume,
  4  functie,
  5  id_sef
  6  from angajati a
  7  where not in(select distinct id_sef
  8  from angajati)
  9  order by id_dep;
where not in(select distinct id_sef
          *
ERROR at line 7:
ORA-00936: missing expression 


SQL> select id_dep,
  2  id_ang,
  3  nume,
  4  functie,
  5  id_sef
  6  from angajati a
  7  where id_sef not in(select distinct id_sef
  8  from angajati)
  9  order by id_dep;

no rows selected

SQL> select a.functie,
  2        (select avg(b.salariu + nvl(b.comision, 0))
  3                from angajati b
  4                where a.functie = b.functie) mediu
  5     from angajati a
  6     group by a.functie;

FUNCTIE        MEDIU                                                            
--------- ----------                                                            
CLERK         1037.5                                                            
SALESMAN        1950                                                            
ANALYST         3000                                                            
MANAGER   2758.33333                                                            
PRESIDENT       5000                                                            

SQL> select nume, functie, grad,     (select avg(salariu) from angajati where functie = a.functie) as "Avg Functie",    (select avg(salariu) from angajati inner join grila_salariu tmp     on salariu between tmp.nivel_inf and tmp.nivel_sup     where tmp.grad = g.grad) as "Avg Grad"from angajati a inner join grila_salariu g on salariu between nivel_inf and nivel_sup where salariu >=      (select avg(salariu) from angajati inner join grila_salariu tmp     on salariu between tmp.nivel_inf and tmp.nivel_sup     where tmp.grad = g.grad)
  2  
SQL> select nume, functie, grad,     (select avg(salariu) from angajati where functie = a.functie) as "Avg Functie",    (select avg(salariu) from angajati inner join grila_salariu tmp     on salariu between tmp.nivel_inf and tmp.nivel_sup     where tmp.grad = g.grad) as "Avg Grad"from angajati a inner join grila_salariu g on salariu between nivel_inf and nivel_sup where salariu >=      (select avg(salariu) from angajati inner join grila_salariu tmp     on salariu between tmp.nivel_inf and tmp.nivel_sup     where tmp.grad = g.grad);

NUME       FUNCTIE         GRAD Avg Functie   Avg Grad                          
---------- --------- ---------- ----------- ----------                          
JAMES      CLERK              1      1037.5        950                          
ADAMS      CLERK              1      1037.5        950                          
MILLER     CLERK              2      1037.5 1266.66667                          
ALLEN      SALESMAN           3        1400       1550                          
SCOTT      ANALYST            4        3000       2855                          
FORD       ANALYST            4        3000       2855                          
JONES      MANAGER            4  2758.33333       2855                          
KING       PRESIDENT          5        5000       5000                          

8 rows selected.

SQL> select nume, den_dep, functie, salariu + nvl(comision, 0) from angajati a
  2      inner join departamente on a.id_dep = departamente.id_dep
  3  where not salariu + nvl(comision, 0) < some(select salariu + nvl(comision, 0)
  4      from angajati where id_dep = a.id_dep and
  5      salariu + nvl(comision, 0) > a.salariu + nvl(a.comision, 0))
  6  order by 2;

NUME       DEN_DEP        FUNCTIE   SALARIU+NVL(COMISION,0)                     
---------- -------------- --------- -----------------------                     
KING       ACCOUNTING     PRESIDENT                    5000                     
FORD       RESEARCH       ANALYST                      3000                     
SCOTT      RESEARCH       ANALYST                      3000                     
BLAKE      SALES          MANAGER                      2850                     

SQL> select nume, den_dep, functie, salariu + nvl(comision, 0) from angajati a
  2      inner join departamente on a.id_dep = departamente.id_dep
  3  where salariu + nvl(comision, 0) >= all(select salariu + nvl(comision, 0)
  4      from angajati where id_dep = a.id_dep)
  5  order by 2;

NUME       DEN_DEP        FUNCTIE   SALARIU+NVL(COMISION,0)                     
---------- -------------- --------- -----------------------                     
KING       ACCOUNTING     PRESIDENT                    5000                     
FORD       RESEARCH       ANALYST                      3000                     
SCOTT      RESEARCH       ANALYST                      3000                     
BLAKE      SALES          MANAGER                      2850                     

SQL> select nume, den_dep, functie, salariu + nvl(comision, 0) from angajati a
  2      inner join departamente on a.id_dep = departamente.id_dep
  3  where not exists (select nume from angajati where id_dep = a.id_dep
  4      and  salariu + nvl(comision, 0) > a.salariu + nvl(a.comision, 0))
  5  order by 2;

NUME       DEN_DEP        FUNCTIE   SALARIU+NVL(COMISION,0)                     
---------- -------------- --------- -----------------------                     
KING       ACCOUNTING     PRESIDENT                    5000                     
SCOTT      RESEARCH       ANALYST                      3000                     
FORD       RESEARCH       ANALYST                      3000                     
BLAKE      SALES          MANAGER                      2850                     

SQL> spool off
